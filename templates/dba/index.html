{% extends 'base.html' %}

{% block script %}
<script>
    $( document ).ready(function() {
        $('#hosts').bind("change", { 
            msg:"hostchange" 
        },function(event) { 
            $('#sucheForm').submit();
        });
    });
</script>

{% endblock script %}
{% block content %}
{% if debugmessage %}
<fieldset>
    <legend>Debugmessage</legend>
    <pre>
    {{debugmessage}}
    </pre>
</fieldset>
{% endif %}
<form id="sucheForm" action="/" method="post">
{% csrf_token %}
<h3 id="filterMenu" class="menuHeadStatic" style="margin-top:-1px;">
    <span class="headline" style="text-align:left;width:80%;">Voreinstellungen</span>
   </h3>
   <div id="einstellungMenuListe" class="menuExpandStatic" style="padding-top:5px;">
    <div style="float:left;width:400px;">
     <label class="left" for="suche" style="width:80px;">Suchen:</label>
     <div id="klientListeDiv" style="float:left;">
      <input type="text" name="suche" value="" id="such">
     </div>
     <br class="end">
     <label class="left" style="width:80px;">Server:</label>
        <select name="hosts" id="hosts" style="float:left;">
            <option value="">Bitte einen Server wählen</option>
            {% if host_list %}
                {% for host in host_list %}
                <option value="{{ host.name }}" {{ host.selected }}>{{ host.fqdn }} ({{host.driver}})</option>
                {% endfor %}
            {% else %}
                <option value="">Keine Hosts konfiguriert</option>
            {% endif %}
        </select>
     <br class="end">
     {% if instance_list %}
     <label class="left" style="width:80px;">Instanz:</label>
        <select name="instances" id="instances" style="float:left;">
            <option value="">Bitte eine Instanz wählen</option>
                {% for instance in instance_list %}
                <option value="{{ instance.name }}" {{ instance.selected }}>{{ instance.name }}</option>
                {% endfor %}
        </select>
        {% endif %}
     <br class="end">
    </div>
    <div style="float:left;width:400px;">
     <label class="left" for="suchenIn" style="margin-right:1em;margin-left:1em;width:100px;">Suchen in:</label>
     <select name="suchenIn" id="suchenIn" style="float:left;">
        <option value="alles">Alles (Namen/Akz/Anschrift)</option>
     </select>
     <br class="end">
     <label class="left" for="fallart" style="margin-right:1em;margin-left:1em;width:100px">Zuständigkeit:</label>
     <select name="fallart" id="fallart" style="float:left;">
      <option title="Alle Fälle" value="alle" selected="selected">Alle Fälle</option>
     </select>
    </div>
    <br class="end">
    <input type="submit" name="suchen" value="Suchen" style="background-image: url(../layout/ldeLayout/suchen.png);margin-left:65px;" class="navigationButton">
    <input type="submit" name="nichtsuchen" value="Alles zeigen" style="background-image: url(../layout/ldeLayout/sumliste.png);" class="navigationButton">
    <br class="end">
   </div>
    <div id="navigation">
        <input class="navigationButton" type="submit" style="background-image: url(../layout/ldeLayout/menuAuswahl.png);" value="Auswahl" name="select">
        <input class="navigationButton" type="button" style="background-image: url(../layout/ldeLayout/loeschen.png);" value="Löschen" id="startLoeschen">
        <input class="navigationButton" type="button" style="background-image: url(../layout/ldeLayout/archive.png);" value="Archivieren" id="startArchiv">
    </div>
    <div class="scrollTableContainer" style="float: left; width: 100%; height: 800px;">
{% if db_list %}
    <table class="ldeTable" style="width: 100%;">
        <thead>
            <tr>
                <th widht="16%">Name</th>
                <th style="text-align: right;">Daten</th>
                <th style="text-align: right;">Log</th>
                <th style="text-align: right;">Gesamt</th>
                <th>Vernichtung</th>
                <th>Wiederherstellungsmodell</th>
            </tr>
        </thead>
        <tbody>
            {% for db in db_list %}
            <tr class="{% cycle 'ldeTableRow' 'ldeTableRowAlternative' %}">
                <td>{{ db.name }}</td>
                <td style="text-align: right;">{{ db.size }}</td>
                <td style="text-align: right;">{{ db.log }}</td>
                {% if db.sum > 5000 %}
                <td style="text-align: right; color: red;">{{ db.sum }}</td>
                {% else %}
                <td style="text-align: right; color: green;">{{ db.sum }}</td>
                {% endif %}
                {% if db.delta < -8999 %}
                <td style="color: white; background-color: red;">{{ db.delete }}</td>
                {% elif db.delta < 0 %}
                <td style="color: red;">{{ db.delete }}</td>
                {% else %}
                <td style="color: green;">{{ db.delete }}</td>
                {% endif %}
                <td>{{ db.add }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr><td colspan="5"></td></tr>
        </tfoot>
    </table>
{% endif %}
</div>
</form>
{% endblock content %}